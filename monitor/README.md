# monitor

## Приложение для визуализации событий на эксгуастере


Приложение основано на front-end фреймвокре `Vue.js` и back-end `FastAPI`, также используется СУБД `PostgreSQL`. 

На данный момент приложение реализует только функционал по отслеживанию событий.

В приложение загружены данные из обучающей выборки по Эксгуастеру №4.

Был сделан ресемпл с шагом 4 часа и загружен в базу:

```
y_exh4.resample('4H').max().to_sql('events',conn, index_label='event_ts')
```

В приложении можно запустить "плеер" и начнется подгружаться данные по событиям по таймстампу из загруженного диапазона.

Пришедшие события делятся на 2 типа:

- мы смогли нарисовать на эксгуастере
- мы не смогли нарисовать на эксгуастере или просто не знаем что это такое ;(

То, что мы нарисовали, подсвечивается красным цветом на 5 секунд, все остальные события попадают в стэк из пяти карточек. При переполнении стэка, событие из начала стэка удаляется.


Макет эксгуастера был сделан в `FreeCAD` и экспортирован в `THREE.js`. Для добавления новых объектов, необходимо их добавить в модель и проименовать, тогда после экспора эти имена будут доступны для подсветки.

Мы подсвечиваем следующие компоненты:
- ЭКСГАУСТЕР А/М
- ПОДШИПНИК ОПОРНЫЙ №1
- ПОДШИПНИК ОПОРНЫЙ №2
- ПОДШИПНИК ОПОРНЫЙ №3
- ПОДШИПНИК ОПОРНЫЙ №4
- КОРПУС
- МАСЛООХЛАДИТЕЛЬ  М-05-1
- ЭЛЕКТРОДВИГАТЕЛЬ ДСПУ-140-84-4

Сейчас модель __вшита__ в код как и сопоставление частей модели и реальных частей эксгуастера.

## Установка

Для развертывания проекта потребуется `npm` версии не ниже `9.5.1`. 

Back-end:
```
cd monitor
npm install
```

Front-end:
```
cd monitor
pip install -r dependencies.txt
```

## Сборка

Front-end необходимо собрать:
```
npm run build-dev
```
После сборки должна появиться папка `dist` со всеми необходимыми для работы front-end'а файлами.


### Запуск

Для запуска необходимо добавить переменные окружения с данными пользователя базы данных:

```
export DB_USER=username
export DB_PASSWORD='Pa$s\/\/orD'
export DB_HOST=localhost
```

Для запуска можно запустить приложение через __python__:
```
cd monitor
python app.py
```

Или через `uvicorn`
```
uvicorn app:app --host 0.0.0.0 --port 8080
```